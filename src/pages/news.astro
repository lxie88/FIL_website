---
import Layout from '~/layouts/PageLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../utils/consts';
import { Icon } from 'astro-icon/components';

// Sample news data - in a real application, this would come from a CMS or database
const newsItems = [
  {
    title: 'PhD/MS Student Recruitment for Spring/Fall 2025',
    excerpt: 'We are seeking motivated PhD/MS students to join our lab in Spring/Fall 2025! Full financial support is available. You will receive hands on training, perform exciting fluid mechanics research in biomedical or/and aerospace engineering, and present your work at national conferences.',
    date: 'October 15, 2024',
    category: 'Announcement',
    categoryColor: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
    link: '/news/student-recruitment-2025',
    featured: true,
  },
  {
    title: 'Research Grant Awarded by NASA',
    excerpt: 'We are excited to announce our proposal, "Nexus of Neutronics-Thermal Fluid Analysis for Optimizing Centrifugal Nuclear Thermal Propulsion," has been selected for funding! As the Principal Investigator, Dr. Huang Chen will work with Dr. Yi-Tung Chen to conduct a preliminary optimization study of Centrifugal Nuclear Thermal Propulsion (CNTP) engines.',
    date: 'July 28, 2024',
    category: 'Grant',
    categoryColor: 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200',
    link: '/news/nasa-grant-2024',
    featured: false,
  },
  {
    title: 'New Role: Tenure-Track Assistant Professor at UNLV',
    excerpt: 'I\'m excited to announce that I\'ll be starting a new role as a Tenure-Track Assistant Professor at the University of Nevada-Las Vegas this fall. I\'ll be diving into using advanced fluid measurement and simulation techniques to study complex flows associated with aerospace and biomedical applications. A big thanks to everyone who\'s been there with support and encouragement along the way.',
    date: 'August 21, 2023',
    category: 'Achievements',
    categoryColor: 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200',
    link: '/news/unlv-faculty-2023',
    featured: false,
  },
  {
    title: 'Presentation at 75th APS DFD Annual Meeting',
    excerpt: 'I am excited to present our work at the 75th APS DFD annual meeting in Indianapolis! We have demonstrated how to quantify particle residence time and blood damage in an intracranial aneurysm using 3D time-resolved particle tracking. We have also looked at the effects of inflow pulsatility on the blood residence time in the aneurysm. This work can help evaluate the efficacy of the treatment for brain aneurysms using flow diversion stents. It opens the possibility to directly quantify blood damage in other medical devices using 3D flow measurement techniques.',
    date: 'November 20, 2022',
    category: 'Conference',
    categoryColor: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
    link: '/news/aps-dfd-2022',
    featured: false,
    hasImage: true,
    image: '/images/news/conference1.jpg',
    imageAlt: 'APS DFD Conference Presentation',
  },
  {
    title: 'Publication in JTCVS Open',
    excerpt: 'Our paper titled "Effects of Implantation Height on the Performance of a Redo Transcatheter Aortic Valve Replacement Using a Balloon-Expandable Valve" has been accepted for publication in the JTCVS Open! This groundbreaking study examines how implantation height affects valve performance in TAVR-in-TAVR procedures, providing crucial insights for clinicians as these procedures become more common. The research team includes Huang Chen, Milad Samaee, Pradeep Yadav, Vinod Thourani, and Lakshmi Dasi.',
    date: 'June 15, 2024',
    category: 'Publications',
    categoryColor: 'bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200',
    link: '/research/publications#tavr-in-tavr-study',
    featured: false,
    hasImage: true,
    image: '/images/news/paper2.png',
    imageAlt: 'TAVR-in-TAVR Study Results',
  },
  {
    title: 'Publication in Annals of Biomedical Engineering: 3D Particle Tracking Study',
    excerpt: 'Our paper titled "An In-Vitro Study of the Flow past a Transcatheter Aortic Valve Using Time-Resolved 3D Particle Tracking" has been accepted for publication in the Annals of Biomedical Engineering! It is our first paper using 3D particle tracking to study the flow structures, particle residence time, and pressure downstream of a heart valve. The method will lead to more high-impact in vitro studies in the future. Stay tuned!',
    date: 'November 9, 2023',
    category: 'Publications',
    categoryColor: 'bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200',
    link: '/research/publications#3d-particle-tracking',
    featured: false,
    hasImage: true,
    image: '/images/news/paper3.gif',
    imageAlt: '3D Particle Tracking Results',
    imageClass: 'max-w-[200px]',
  },
  {
    title: 'Fontan Circulation Support Device Grant Awarded',
    excerpt: 'Our proposal for "Mechanically Assisted Establishment of Biventricular Physiology for Failing Fontan Circulation" has been recommended for funding. We will develop a novel mechanical circulatory device using aerospace-inspired technology to support failing Fontan patients with high flow rates and low pressure rises.',
    date: 'August 5, 2024',
    category: 'Grant',
    categoryColor: 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200',
    link: '/news/fontan-grant-2024',
    featured: true,
  },
  {
    title: 'DoD Awards $7.8M LVAD Research Grant',
    excerpt: 'Our team has been awarded a $7.8M DoD grant to develop a novel LVAD with wireless power transfer and antithrombotic coating. As Co-Investigator, Dr. Huang Chen will collaborate with Georgia Tech, NC State, Rice University, and Texas Heart Institute.',
    date: 'Jan 15, 2023',
    category: 'Grant',
    categoryColor: 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200',
    link: '/news/lvad-grant-2024',
    featured: false,
    hasLogo: true,
    logoAlt: 'Department of Defense Logo',
  },
];

// Get unique categories
const categories = [...new Set(newsItems.map(item => item.category))];

// Sort news items by date (newest first)
const sortedNewsItems = [...newsItems].sort((a, b) => {
  const dateA = new Date(a.date);
  const dateB = new Date(b.date);
  return dateB - dateA;
});

// Get featured news
const featuredNews = sortedNewsItems.find(item => item.featured);

// Get regular news items
const regularNews = sortedNewsItems.filter(item => !item.featured);

// Get recent posts for sidebar
const recentPosts = sortedNewsItems.slice(0, 5);

// Category colors
const categoryColors = {
  Announcement: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
  Conference: 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
  Collaboration: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
  Awards: 'bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200',
  Publications: 'bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-200',
  Achievements: 'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200',
  Grant: 'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-200',
};

const metadata = {
  title: 'Lab News - Fluid Innovation Lab',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 lg:py-20 max-w-7xl">
    <div class="max-w-2xl mx-auto text-center mb-16">
      <p class="text-base text-secondary dark:text-blue-200 font-bold tracking-wide uppercase mb-2">
        Latest Updates
      </p>
      <h1 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter mb-4 font-heading bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-teal-400">
        Lab News
      </h1>
      <p class="text-xl text-muted dark:text-slate-400">
        Stay updated with the latest developments and achievements at the Fluid Innovation Lab
      </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
      <!-- Main Content -->
      <div class="lg:col-span-3">
        {featuredNews && (
          <div class="mb-12">
            <article class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-8 hover:shadow-xl transition-all duration-300">
              <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                <span class={`inline-block px-3 py-1 rounded-full text-sm font-semibold ${categoryColors[featuredNews.category]}`}>
                  {featuredNews.category}
                </span>
                <span class="text-sm text-muted dark:text-slate-400 flex items-center mt-2 md:mt-0">
                  <Icon name="tabler:calendar" class="w-4 h-4 mr-1" />
                  {featuredNews.date}
                </span>
              </div>
              <h2 class="text-3xl md:text-4xl font-bold mb-4 group-hover:text-primary-300 transition-colors text-gray-800 dark:text-white">
                {featuredNews.title}
              </h2>
              <p class="text-lg mb-6 text-gray-700 dark:text-gray-300">{featuredNews.excerpt}</p>
              <a
                href={featuredNews.link}
                class="inline-flex items-center transition-colors text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 font-medium"
              >
                Read full article
                <Icon name="tabler:arrow-right" class="w-4 h-4 ml-1" />
              </a>
            </article>
          </div>
        )}

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {regularNews.map((item) => (
            <article class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group">
              <a href={item.link} class="block">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                  <span class={`inline-block px-3 py-1 rounded-full text-xs font-semibold ${categoryColors[item.category]}`}>
                    {item.category}
                  </span>
                  <span class="text-sm text-muted dark:text-slate-400 flex items-center mt-2 md:mt-0">
                    <Icon name="tabler:calendar" class="w-4 h-4 mr-1" />
                    {item.date}
                  </span>
                </div>
                <h3 class="text-xl font-bold leading-tight mb-3 font-heading hover:text-primary dark:hover:text-primary-400 transition-colors">
                  {item.title}
                </h3>
                {item.hasImage && (
                  <div class="w-full mb-4 flex justify-center">
                    <img 
                      src={item.image}
                      alt={item.imageAlt}
                      class={`max-w-[300px] w-full h-auto rounded-lg shadow-md ${item.imageClass || ''}`}
                      onerror="this.style.display='none'"
                    />
                  </div>
                )}
                <div class="flex items-start gap-4">
                  {item.hasLogo && (
                    <div class="flex-shrink-0 mt-1">
                      <img 
                        src="/images/logos/dod-logo.png" 
                        alt={item.logoAlt || "Logo"} 
                        class="h-12 w-auto"
                        onerror="this.style.display='none'"
                      />
                    </div>
                  )}
                  <div class="flex-grow">
                    <p class="text-muted dark:text-slate-400 mb-4 line-clamp-3 group-hover:line-clamp-none transition-all duration-300">{item.excerpt}</p>
                    <a
                      href={item.link}
                      class="text-primary hover:underline dark:text-primary-400 inline-flex items-center font-medium"
                    >
                      Read more
                      <Icon name="tabler:chevron-right" class="w-4 h-4 ml-1" />
                    </a>
                  </div>
                </div>
              </a>
            </article>
          ))}
        </div>
      </div>

      <!-- Sidebar -->
      <aside class="lg:col-span-1">
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 mb-8 border border-slate-100 dark:border-slate-700">
          <h3 class="text-xl font-bold mb-4 flex items-center">
            <Icon name="tabler:category" class="w-5 h-5 mr-2 text-primary-600 dark:text-primary-400" />
            Categories
          </h3>
          <div class="space-y-2">
            {categories.map(category => (
              <a
                href={`/news/category/${category.toLowerCase()}`}
                class="block py-2 px-4 rounded-lg hover:bg-primary-50 dark:hover:bg-slate-700 transition-colors duration-200 flex items-center justify-between group"
              >
                <span>{category}</span>
                <Icon name="tabler:chevron-right" class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity" />
              </a>
            ))}
          </div>
        </div>

        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-6 border border-slate-100 dark:border-slate-700">
          <h3 class="text-xl font-bold mb-4 flex items-center">
            <Icon name="tabler:clock" class="w-5 h-5 mr-2 text-primary-600 dark:text-primary-400" />
            Recent Posts
          </h3>
          <div class="space-y-4">
            {recentPosts.map(post => (
              <a href={post.link} class="block group">
                <div>
                  <h4 class="font-medium group-hover:text-primary dark:group-hover:text-primary-400 transition-colors line-clamp-2">
                    {post.title}
                  </h4>
                  <span class="text-sm text-muted dark:text-slate-400 flex items-center mt-1">
                    <Icon name="tabler:calendar" class="w-3 h-3 mr-1" />
                    {post.date}
                  </span>
                </div>
              </a>
            ))}
          </div>
        </div>
      </aside>
    </div>
  </section>
</Layout> 